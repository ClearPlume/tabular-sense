# Tabular Sense

> 表格数据语义识别：理解结构化数据的语义信息

## 项目简介

Tabular Sense 是一个基于小语言模型（SLM）的表格数据语义识别工具。通过分析列名和数据样本，自动识别列的语义类型。

**核心特点**：

- **自动识别**：从列名和样本自动推断语义类型
- **多格式支持**：识别同一类型的各种格式变体
- **鲁棒推理**：通过多采样策略提高识别准确率

**开发阶段**：

- 阶段1：单列类型识别（当前）
- 阶段2：表级别关联识别（规划中，如经纬度对、关联列等）

## 支持的类型

当前支持识别 **32种** 语义类型，分为三大类：

### Corpus 类型(6种) - 完整数据集采样

基于完整原始数据集随机采样，单一格式表达。

- **个人信息**：姓名、用户名
- **联系方式**：邮箱
- **网络数据**：URL、User Agent
- **职业信息**：职业

### Variant 类型(20种) - 多格式变体生成

通过格式生成规则产生，同一语义具有多种格式表达。

- **枚举类型**：性别、民族、教育程度、状态、优先级、布尔值
- **个人信息**：年龄、身份证号
- **联系方式**：手机号
- **财务数据**：银行卡号、金额
- **地理信息**：坐标、车牌号
- **时间数据**：日期、时间、日期时间
- **网络数据**：IP地址
- **数值类型**：整数、浮点数、百分比

### Seed 类型(6种) - 种子数据扩展

基于部分种子数据组合变换生成，单一格式表达。

- **地理位置**：地址、住宅小区
- **组织机构**：公司名称、医疗机构、娱乐场所、商超

## 工作原理

### 阶段1：单列识别

```
输入: 列名 + 数据样本
  ↓
文本编码
  列名|样本1<sep>样本2<sep>样本3...
  ↓
Transformer Encoder
  ↓
分类器（32类）
  ↓
输出: 语义类型标签
```

**输入格式说明**：

- 列名与数据用 `|` 分隔（描述信息）
- 数据样本间用 `<sep>` 分隔（本体内容）

**示例**：

```
phone_number|13812345678<sep>13998765432<sep>15012341234
→ 手机号
```

### 阶段2：表级别关联（规划中）

- 识别列间关系（如经度-纬度配对）
- 利用上下文信息增强识别准确率

## 快速开始

### 安装依赖

本项目使用 [uv](https://github.com/astral-sh/uv) 管理依赖。

```bash
uv sync
```

### 训练数据和样本生成

```bash
python scripts/sample_generator.py
```

### 推理

> ⚠️ 推理接口将在v1.0版本提供

计划的使用方式：

```python
from src.tabular_sense import ColumnClassifier

classifier = ColumnClassifier()

# 识别单列
result = classifier.predict(
    column_name="phone",
    samples=["13812345678", "13998765432", "15012341234"],
)
print(result)  # ['PHONE']
```

## 技术架构

- **模型**：Transformer Encoder + 分类头
- **训练数据**：程序化生成，覆盖各种格式变体
- **推理策略**：多采样 + 投票机制

## 开发计划

### 已完成 ✅

- [x] 项目框架搭建
- [x] 数据生成系统（32类生成器）
- [x] 样本构建与预处理
- [x] 模型架构设计（Transformer + Multi-label BCE）
- [x] 训练流程实现（gradient监控 + metrics追踪）
- [x] 小规模验证（16K样本，500/类）← 系统健康性验证
- [x] 中等规模训练（160K样本，5K/类）
- [x] 大规模训练（960K样本，30K/类）← 生产级目标
- [x] 测试集最终评估 ← 0.99733915
- [x] 推理接口封装（ColumnClassifier）

### 进行中 🚧

- [ ] 性能基准测试与优化

### 规划中 ⏳

- [ ] 交互式演示工具
- [ ] 扩展到表级别语义理解
